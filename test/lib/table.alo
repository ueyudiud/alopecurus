if (table == nil) {
    print("no library 'table', skipped")
    return
}

let mut t = table('v')
let mut k = {}
let mut v = {}

assert(#t == 0)

t[k] = v
assert(#t == 1)

k = nil
sys.gc()
assert(#t == 1)

v = nil
sys.gc()
assert(#t == 0)

t = table('k')
k = {}
v = {}

assert(#t == 0)

t[k] = v
assert(#t == 1)

v = nil
sys.gc()
assert(#t == 1)

k = nil
sys.gc()
assert(#t == 0)

t = table('kv')
k = {}
v = {}

assert(#t == 0)

t[k] = v
assert(#t == 1)

v = nil
sys.gc()
assert(#t == 0)

k = nil
sys.gc()
assert(#t == 0)
